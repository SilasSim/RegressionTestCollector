<Window x:Class="RegressionTestCollector.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:behaviors="clr-namespace:RegressionTestCollector.Behaviors"
        xmlns:uc="clr-namespace:RegressionTestCollector.Controls"
        xmlns:converters="clr-namespace:RegressionTestCollector.Converters"
        xmlns:properties="clr-namespace:RegressionTestCollector.Resources"
        mc:Ignorable="d"
        WindowStyle="None"
        Title="Regression Test Collector" Height="675" Width="1200"
        Background="{DynamicResource Brush.BackgroundColor}"
        Icon="Resources/iconLight.ico"
        >
  <Window.Resources>
    <Style TargetType="MenuItem">
      <Setter Property="Cursor" Value="Hand" />
    </Style>
    <converters:MenuItemSelectionMatchConverter x:Key="MenuItemSelectionMatchConverter" />
  </Window.Resources>

  <Grid x:Name="MainGrid" Style="{StaticResource GridStyle}">
    <Grid.Resources>
      <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
      <converters:InverseBooleanConverter x:Key="InverseBooleanConverter" />

      <Style x:Key="StatusBarStyle" TargetType="RowDefinition">
        <Setter Property="Height" Value="Auto" />
        <Style.Triggers>
          <DataTrigger Binding="{Binding IsLoadingData}" Value="False">
            <Setter Property="Height" Value="0" />
          </DataTrigger>
        </Style.Triggers>
      </Style>
      <Style x:Key="OutputVisibilityStyle" TargetType="RowDefinition">
        <Setter Property="Height" Value="Auto" />
        <Style.Triggers>
          <DataTrigger Binding="{Binding OutputControlViewModel.IsVisible}" Value="False">
            <Setter Property="Height" Value="0" />
          </DataTrigger>
        </Style.Triggers>
      </Style>
    </Grid.Resources>

    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Style="{StaticResource StatusBarStyle}" />
      <RowDefinition x:Name="SearchTableRowDefinition" Height="*" MinHeight="100" />
      <RowDefinition x:Name="GridSplitterRowDefinition" Style="{StaticResource OutputVisibilityStyle}" />
      <RowDefinition x:Name="OutputControlRowDefinition" Style="{StaticResource OutputVisibilityStyle}" />
    </Grid.RowDefinitions>

    <uc:TitlebarControl Grid.Row="0" 
                        HostWindow="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                        SelectedTheme="{Binding MenuViewModel.SelectedTheme}"
                        Background="{DynamicResource Brush.Titlebar}"/>

    <Grid Grid.Row="1">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>

      <Menu Style="{StaticResource MenuStyle}" IsEnabled="{Binding IsLoadingData, Converter={StaticResource InverseBooleanConverter}}">
        <MenuItem Header="{x:Static properties:Strings.MenuLoad}" Command="{Binding LoadRegressionTestsCommand}" />

        <MenuItem Header="{x:Static properties:Strings.MenuOptions}">
          <MenuItem Header="{x:Static properties:Strings.MenuSelectCollectingMethod}">
            <MenuItem Header="{x:Static properties:Strings.MenuCollectingMethodPythonName}" 
                      IsCheckable="True" 
                      IsChecked="{Binding MenuViewModel.SelectedStrategy, Mode=OneWay ,
                        Converter={StaticResource MenuItemSelectionMatchConverter}, 
                        ConverterParameter={x:Static properties:Strings.MenuCollectingMethodPythonName}}"
                      Command="{Binding ChangeCollectingStrategyCommand}" CommandParameter="{x:Static properties:Strings.MenuCollectingMethodPythonName}"
                      behaviors:MenuGroup.GroupName="SelectedCollectingMethod">
              <MenuItem.ToolTip>
                <ToolTip Content="{x:Static properties:Strings.MenuCollectingMethodPythonTooltip}" />
              </MenuItem.ToolTip>

            </MenuItem>

            <MenuItem Header="{x:Static properties:Strings.MenuCollectingMethodCSharpName}" 
                    IsCheckable="True" 
                    IsChecked="{Binding MenuViewModel.SelectedStrategy, Mode=OneWay ,
                      Converter={StaticResource MenuItemSelectionMatchConverter}, 
                      ConverterParameter={x:Static properties:Strings.MenuCollectingMethodCSharpName}}"
                    Command="{Binding ChangeCollectingStrategyCommand}" CommandParameter="{x:Static properties:Strings.MenuCollectingMethodCSharpName}"
                    behaviors:MenuGroup.GroupName="SelectedCollectingMethod">
              <MenuItem.ToolTip>
                <ToolTip Content="{x:Static properties:Strings.MenuCollectingMethodCSharpTooltip}" />
              </MenuItem.ToolTip>
            </MenuItem>
          </MenuItem>

          <MenuItem Header="{x:Static properties:Strings.MenuSelectPythonCommand}">
            <MenuItem.ToolTip>
              <ToolTip Content="{x:Static properties:Strings.MenuSelectPythonCommandTooltip}" />
            </MenuItem.ToolTip>
            <MenuItem Header="{x:Static properties:Strings.MenuPythonCommandPython3}" 
                    IsCheckable="True" 
                    IsChecked="{Binding MenuViewModel.SelectedPythonCommand, Mode=OneWay ,
                                  Converter={StaticResource MenuItemSelectionMatchConverter}, 
                                  ConverterParameter={x:Static properties:Strings.MenuPythonCommandPython3}}"
                    Command="{Binding ChangePythonCommandCommand}" CommandParameter="{x:Static properties:Strings.MenuPythonCommandPython3}"
                    behaviors:MenuGroup.GroupName="SelectedPythonCommand">
            </MenuItem>

            <MenuItem Header="{x:Static properties:Strings.MenuPythonCommandPython}" 
                    IsCheckable="True" 
                    IsChecked="{Binding MenuViewModel.SelectedPythonCommand, Mode=OneWay ,
                     Converter={StaticResource MenuItemSelectionMatchConverter}, 
                     ConverterParameter={x:Static properties:Strings.MenuPythonCommandPython}}" 
                    Command="{Binding ChangePythonCommandCommand}" CommandParameter="{x:Static properties:Strings.MenuPythonCommandPython}"
                    behaviors:MenuGroup.GroupName="SelectedPythonCommand">
            </MenuItem>
          </MenuItem>

          <MenuItem Header="{x:Static properties:Strings.MenuThemes}">
            <MenuItem Header="{x:Static properties:Strings.MenuThemeLight}" 
                      IsCheckable="True"
                      IsChecked="{Binding MenuViewModel.SelectedTheme, Mode=OneWay ,
                       Converter={StaticResource MenuItemSelectionMatchConverter}, 
                       ConverterParameter={x:Static properties:Strings.MenuThemeLight}}" 
                      Command="{Binding ChangeThemeCommand}"
                      CommandParameter="{x:Static properties:Strings.MenuThemeLight}"
                      behaviors:MenuGroup.GroupName="SelectedTheme"></MenuItem>
            <MenuItem Header="{x:Static properties:Strings.MenuThemeDark}" IsCheckable="True"
                      IsChecked="{Binding MenuViewModel.SelectedTheme, Mode=OneWay ,
                        Converter={StaticResource MenuItemSelectionMatchConverter}, 
                        ConverterParameter={x:Static properties:Strings.MenuThemeDark}}"  
                      Command="{Binding ChangeThemeCommand}"
                      CommandParameter="{x:Static properties:Strings.MenuThemeDark}"
                      behaviors:MenuGroup.GroupName="SelectedTheme"></MenuItem>
          </MenuItem>
          <MenuItem Header="{x:Static properties:Strings.HighlighterMenu}">
            <MenuItem Header="{x:Static properties:Strings.HighlighterIsTurnedOffOptionLabel}" IsCheckable="True" 
                      IsChecked="{Binding SearchTableViewModel.Highlighter.IsTurnedOff}"></MenuItem>
          </MenuItem>
        </MenuItem>
        <MenuItem Header="{x:Static properties:Strings.MenuHelp}">
          <MenuItem Header="{x:Static properties:Strings.MenuHelpNotImplemented}" IsCheckable="True" IsChecked="False"></MenuItem>
        </MenuItem>
      </Menu>
      <Menu Grid.Column="1" Style="{StaticResource MenuStyle}">
        <MenuItem Header="{x:Static properties:Strings.MenuShowOutput}" IsCheckable="True" IsChecked="{Binding OutputControlViewModel.IsVisible}" />
      </Menu>
    </Grid>
    <StatusBar Grid.Row="2">
      <StatusBarItem HorizontalContentAlignment="Stretch">
        <Grid>
          <ProgressBar Maximum="{Binding LoadingProgress.Max}" Value="{Binding LoadingProgress.Current}" Background="Transparent" />
          <TextBlock Margin="20 0 0 0" FontSize="30" Text="{Binding LoadingDataText}" Background="Transparent" />
          <Button HorizontalAlignment="Right" FontSize="20" Width="40" Height="40"
                  BorderThickness="0" Content="{x:Static properties:Strings.CancelLoadingProcessButton}" Command="{Binding CancelLoadingCommand}" />
        </Grid>
      </StatusBarItem>


    </StatusBar>
    <uc:SearchTable DataContext="{Binding SearchTableViewModel}" Grid.Row="3">
    </uc:SearchTable>

    <GridSplitter Grid.Row="4" Height="5"
                  Visibility="{Binding OutputControlViewModel.IsVisible, Converter={StaticResource BooleanToVisibilityConverter}}"
                  Style="{StaticResource GridSplitterStyle}"
                  HorizontalAlignment="Stretch" 
                  ShowsPreview="False" 
                  ResizeDirection="Rows" 
                  Cursor="SizeNS" 
                  BorderThickness="4"></GridSplitter>

    <uc:OutputControl Grid.Row="5" DataContext="{Binding OutputControlViewModel}" 
                      Visibility="{Binding IsVisible, Converter={StaticResource BooleanToVisibilityConverter}}"
                      behaviors:ScrollbarWheelBehavior.EnableHorizontalScroll="True">
    </uc:OutputControl>


  </Grid>
</Window>
